@model RealEstateSystem.ViewModels.AdminDashboardViewModel
@{
    Layout = "_AdminLayout";
    ViewData["PageTitle"] = "Dashboard";
    ViewData["PageSubtitle"] = "Overview of users, listings and system activity.";
}

<!-- OVERVIEW CARDS -->
<section class="grid grid-4 overview">
    <article class="stat-card is-active"
             style="cursor:pointer;"
             onclick="window.location='@Url.Action("Index", "AdminUsers")'">
        <p class="stat-label">Total Users</p>
        <p class="stat-value" id="totalUsers"
           data-counter data-target="@Model.TotalUsers">
            @Model.TotalUsers
        </p>
        <p class="stat-meta">Admins, Sellers &amp; Buyers</p>
    </article>

    <article class="stat-card"
             style="cursor:pointer;"
             onclick="window.location='@Url.Action("Buyers", "AdminUsers")'">
        <p class="stat-label">Total Buyers</p>
        <p class="stat-value" id="totalBuyers"
           data-counter data-target="@Model.TotalBuyers">
            @Model.TotalBuyers
        </p>
        <p class="stat-meta">Registered customers</p>
    </article>

    <article class="stat-card"
             style="cursor:pointer;"
             onclick="window.location='@Url.Action("Sellers", "AdminUsers")'">
        <p class="stat-label">Total Sellers</p>
        <p class="stat-value" id="totalSellers"
           data-counter data-target="@Model.TotalSellers">
            @Model.TotalSellers
        </p>
        <p class="stat-meta">Agents &amp; property owners</p>
    </article>

    <article class="stat-card"
             style="cursor:pointer;"
             onclick="window.location='@Url.Action("ActiveListings", "AdminProperties")'">
        <p class="stat-label">Active Listings</p>
        <p class="stat-value" id="activeListings"
           data-counter data-target="@Model.ActiveListings">
            @Model.ActiveListings
        </p>
        <p class="stat-meta">Currently visible to buyers</p>
    </article>
</section>

<!-- MIDDLE ROW -->
<section class="grid grid-2 middle">
    <article class="card">
        <div class="card-header">
            <h2>Listing &amp; Sales Overview</h2>
            <span class="card-tag">Last 6 months</span>
        </div>

        <div class="chart-sample">
            <div class="chart-legend">
                <span><span class="legend-dot legend-listings"></span> New listings</span>
                <span><span class="legend-dot legend-sold"></span> Sold properties</span>
            </div>

            <div class="chart-bars">
                <div class="chart-col">
                    <div class="bar-group">
                        <div class="bar bar-listings" style="height: 90px;"></div>
                        <div class="bar bar-sold" style="height: 60px;"></div>
                    </div>
                    <span class="chart-label">Jan</span>
                </div>
                <div class="chart-col">
                    <div class="bar-group">
                        <div class="bar bar-listings" style="height: 110px;"></div>
                        <div class="bar bar-sold" style="height: 80px;"></div>
                    </div>
                    <span class="chart-label">Feb</span>
                </div>
                <div class="chart-col">
                    <div class="bar-group">
                        <div class="bar bar-listings" style="height: 75px;"></div>
                        <div class="bar bar-sold" style="height: 50px;"></div>
                    </div>
                    <span class="chart-label">Mar</span>
                </div>
                <div class="chart-col">
                    <div class="bar-group">
                        <div class="bar bar-listings" style="height: 120px;"></div>
                        <div class="bar bar-sold" style="height: 90px;"></div>
                    </div>
                    <span class="chart-label">Apr</span>
                </div>
                <div class="chart-col">
                    <div class="bar-group">
                        <div class="bar bar-listings" style="height: 95px;"></div>
                        <div class="bar bar-sold" style="height: 70px;"></div>
                    </div>
                    <span class="chart-label">May</span>
                </div>
                <div class="chart-col">
                    <div class="bar-group">
                        <div class="bar bar-listings" style="height: 85px;"></div>
                        <div class="bar bar-sold" style="height: 65px;"></div>
                    </div>
                    <span class="chart-label">Jun</span>
                </div>
            </div>
        </div>
    </article>

    <article class="card">
        <div class="card-header">
            <h2>Property Category Distribution</h2>
            <span class="card-tag">Current listings</span>
        </div>

        <div class="pie-wrapper">
            <div class="pie-chart">
                <div class="pie-hole"></div>
            </div>

            <div class="pie-legend">
                <div class="legend-row">
                    <span class="legend-color legend-apartments"></span>
                    <span class="legend-label">Apartments</span>
                    <span class="legend-value">45%</span>
                </div>
                <div class="legend-row">
                    <span class="legend-color legend-houses"></span>
                    <span class="legend-label">Houses</span>
                    <span class="legend-value">30%</span>
                </div>
                <div class="legend-row">
                    <span class="legend-color legend-commercial"></span>
                    <span class="legend-label">Commercial</span>
                    <span class="legend-value">15%</span>
                </div>
                <div class="legend-row">
                    <span class="legend-color legend-land"></span>
                    <span class="legend-label">Land</span>
                    <span class="legend-value">10%</span>
                </div>
            </div>
        </div>
    </article>
</section>

<!-- BOTTOM -->
<section class="bottom">
    <article class="card">
        <div class="card-header">
            <div>
                <h2>Pending Property Approvals</h2>
                <p class="card-subtitle">Review recent property submissions from sellers.</p>
            </div>
            <button class="card-link">View all</button>
        </div>

        <div class="table-wrapper">
            <table class="table">
                <thead>
                    <tr>
                        <th>Property</th>
                        <th>Seller</th>
                        <th>Submitted</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody id="pendingPropertiesBody">
                    <tr>
                        <td>Modern Open-Plan Apartment</td>
                        <td>Rahim Real Estate</td>
                        <td>Today, 10:24 AM</td>
                        <td><span class="badge badge-pending">Waiting</span></td>
                    </tr>
                    <tr>
                        <td>City View Family Flat</td>
                        <td>DreamHome Ltd.</td>
                        <td>Yesterday</td>
                        <td><span class="badge badge-review">In review</span></td>
                    </tr>
                    <tr>
                        <td>Commercial Space in Banani</td>
                        <td>Elite Properties</td>
                        <td>2 days ago</td>
                        <td><span class="badge badge-pending">Waiting</span></td>
                    </tr>
                    <tr>
                        <td>Land Plot in Purbachal</td>
                        <td>GreenFields</td>
                        <td>3 days ago</td>
                        <td><span class="badge badge-pending">Waiting</span></td>
                    </tr>
                </tbody>
            </table>
        </div>
    </article>
</section>

@section Scripts {
    <script>
        document.querySelectorAll("[data-counter]").forEach(counter => {
            const target = parseInt(counter.getAttribute("data-target")) || 0;
            let current = 0;
            const increment = Math.max(1, Math.ceil(target / 80));
            const update = () => {
                current += increment;
                if (current >= target) {
                    current = target;
                } else {
                    requestAnimationFrame(update);
                }
                counter.textContent = current.toLocaleString();
            };
            requestAnimationFrame(update);
        });
    </script>
}
